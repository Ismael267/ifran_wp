"use strict";var woostifySearchDelay=function(e){var o=0<arguments.length&&void 0!==e?e:0;return function(e,t){clearTimeout(o),o=setTimeout(e,t)}}(),woostifyMultiSelect=function(){var e=document.querySelectorAll(".woostify-multi-selection");e.length&&e.forEach(function(n){var s=n.querySelector(".woostify-multi-select-value"),a=n.querySelector(".woostify-multi-select-selection"),i=a.querySelector(".woostify-multi-selection-inner"),e=a.querySelector(".woostify-multi-select-search"),c=n.querySelector(".woostify-multi-select-dropdown"),l=function(e){var t=i.querySelectorAll(".woostify-multi-select-id");if(t.length){var o=[];if(t.forEach(function(e){e=e.getAttribute("data-id");e&&!o.includes(e)&&o.push(e)}),!0===e)return o;s.value=o.join("|")}else s.value="default"},r=function(){var e=i.querySelectorAll(".woostify-multi-select-id");e.length&&e.forEach(function(t){var o=t.getAttribute("data-id"),e=t.querySelector(".woostify-multi-remove-id");e&&(e.onclick=function(){var e;t.parentNode&&(n.classList.add("active"),(e=c.querySelector('[data-id="'+o+'"]'))&&e.classList.remove("disabled"),t.remove(),l())})})};r();function d(){var e=c.querySelectorAll(".woostify-multi-select-id");if(e.length)for(var t=0,o=e.length;t<o;t++)e[t].onclick=function(){var e=this,t=e.classList.contains("disabled"),o=e.getAttribute("data-id");t||(e.classList.add("disabled"),e='<span class="woostify-multi-select-id" data-id="'+o+'">'+e.innerHTML+'<i class="woostify-multi-remove-id dashicons dashicons-no-alt"></i></span>',i.insertAdjacentHTML("afterbegin",e),l(),r())}}e&&(e.addEventListener("input",function(){var e=this,t=e.getAttribute("data-nonce"),o=e.value.trim(),s=e.name,e=e.getAttribute("data-search"),i=new Request(ajaxurl,{method:"POST",body:"action="+s+"&security_nonce="+t+"&keyword="+o,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});"immediate"===e?d():o.length<1?c.innerHTML="":woostifySearchDelay(function(){fetch(i).then(function(e){200===e.status?e.json().then(function(e){var t;e.success&&((e=(t=(new DOMParser).parseFromString(e.data,"text/html")).querySelectorAll(".woostify-multi-select-id")).length&&e.forEach(function(e){var t=e.getAttribute("data-id")||"",o=l(!0)||[];o.length&&(o.includes(t)?e.classList.add("disabled"):e.classList.remove("disabled"))}),c.innerHTML=t.body.innerHTML,d())}):console.log("Status Code: "+e.status)}).catch(function(e){c.innerHTML="",console.log(e)})},500)}),e.addEventListener("focus",function(e){n.classList.add("active"),r(),"immediate"===this.getAttribute("data-search")&&d()})),document.addEventListener("click",function(e){var t=e.target,o=t.closest(".woostify-multi-selection"),s=t.classList.contains("woostify-multi-remove-id"),i=t.classList.contains("woostify-multi-select-id"),e=t.classList.contains("woostify-multi-select-search");o==n&&(a===t||s||i||e)||n.classList.remove("active")})})},prevSiblings=function(e){for(var t=[],o=e;o=o.previousElementSibling;)t.push(o);return t},nextSiblings=function(e){for(var t=[],o=e;o=o.nextElementSibling;)t.push(o);return t},siblings=function(e){var t=prevSiblings(e)||[],e=nextSiblings(e)||[];return t.concat(e)},woostifyMultiDependency=function(){var e=document.querySelectorAll(".woostify-multi-dependency");e.length&&e.forEach(function(a){var e=a.querySelectorAll(".woostify-multi-dependency-item [name]");e.length&&e.forEach(function(i,o){var n=i.closest(".woostify-multi-dependency-item");n.getAttribute("data-dependency")&&i.addEventListener("change",function(){var s=i.value,e=parseInt(o)+1,t=a.querySelectorAll(".woostify-multi-dependency-item:nth-child("+e+') ~ .woostify-multi-dependency-item[data-required="'+s+'"]'),e=siblings(n);e.length&&e.forEach(function(e){e.getAttribute("data-required")&&e.classList.remove("active")}),t.length&&t.forEach(function(e){var t=e.getAttribute("data-required"),o=(e.getAttribute("data-value"),new Event("change"));e.querySelector("[name]").dispatchEvent(o),"checkbox"==i.type?i.checked?e.classList.add("active"):e.classList.remove("active"):s==t?e.classList.add("active"):e.classList.remove("active")})})})})},woostifyUpdateValue=function(){var e=document.querySelector(".woostify-featured-setting");!e||(e=e.querySelectorAll('[type="checkbox"]')).length&&e.forEach(function(e){e.onchange=function(){e.value=1==e.value?0:1}})},woostifyDependency=function(){var e=document.querySelectorAll(".woostify-filter-value");e.length&&e.forEach(function(o){o.addEventListener("change",function(){var e=o.closest(".woostify-filter-item"),e=nextSiblings(e);e.length&&o.value.trim()&&e.forEach(function(e){var t=e.getAttribute("data-type");t&&("checkbox"===o.type?o.checked&&t==o.value?e.classList.remove("hidden"):e.classList.add("hidden"):t.includes(o.value)?e.classList.remove("hidden"):e.classList.add("hidden"))})})})},woostifyTabSettings=function(){var e,i=document.querySelector(".woostify-settings-section-tab");!i||(e=i.querySelectorAll(".tab-head-button")).length&&(e.forEach(function(s){s.onclick=function(){var e=s.hash?s.hash.substr(1):"",t=siblings(s),o=i.querySelector('.woostify-setting-tab-content[data-tab="'+e+'"]'),e=siblings(o);s.classList.add("active"),t.length&&t.forEach(function(e){e.classList.remove("active")}),o.classList.add("active"),e.length&&e.forEach(function(e){e.classList.remove("active")})}}),window.addEventListener("load",function(){var e=i.querySelector('a[href="'+window.location.hash+'"]'),t=i.querySelector('a[href="#general"]');e?e.click():t&&t.click()}))},woostifySaveOptions=function(){var r,d,e,u=document.querySelector(".woostify-featured-setting");u&&(r=u.getAttribute("data-id")||"",d=u.getAttribute("data-nonce")||"",(e=u.querySelectorAll(".save-options")).length&&r&&d&&e.forEach(function(l){l.onclick=function(){if(!l.getAttribute("disabled")&&!u.classList.contains("loading")){var e=this,t=r.replace(/-/g,"_"),o=u.querySelectorAll("[name*=woostify_"+t+"]"),s={},i=u.querySelectorAll('[required="required"]'),n=!1;if(u.classList.contains("woostify-ajax-search-product-setting")){var a=u.querySelector(".must-choose-one-option"),c=!!a&&a.querySelector('[type="checkbox"]');if(!(a?a.querySelectorAll('[type="checkbox"]:checked'):[]).length&&c)return void c.focus()}i.length&&i.forEach(function(e){var t=e.value.trim(),o=e.closest(".woostify-setting-tab-content"),s=e.closest(".woostify-filter-item.hidden"),o=o?o.getAttribute("data-tab"):"";s||t||((o=u.querySelector('a[href="#'+o+'"]'))&&!o.classList.contains("active")&&o.click(),n=!0,e.focus())}),n||(u.classList.add("loading"),e.setAttribute("disabled","disabled"),e.innerHTML=woostify_edit_screen.saving+"...",o.length&&o.forEach(function(e,t){e.value.trim()&&(e.name.includes("[]")?s[e.name+"["+t+"]"]=e.value:s[e.name]=e.value)}),t=new Request(ajaxurl,{method:"POST",body:"action=woostify_save_"+t+"_options&security_nonce="+d+"&setting_id="+r+"&options="+JSON.stringify(s),credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}),fetch(t).then(function(e){200===e.status?(u.querySelector(".woostify-settings-section-footer .info-seuccess")||l.insertAdjacentHTML("afterend",'<span class="info-seuccess">'+woostify_edit_screen.saved_success+"</span>"),u.classList.remove("loading")):console.log("Status Code: "+e.status)}).catch(function(){u.classList.remove("loading")}).finally(function(){e.innerHTML=woostify_edit_screen.saved,setTimeout(function(){e.innerHTML=woostify_edit_screen.save,e.removeAttribute("disabled")},1e3)}))}}}))},woostifySaleNotificationRemoveMessage=function(){var e,t=document.querySelector(".woostify-sale-notification-box-message");!t||(e=t.querySelectorAll(".woostify-sale-notification-remove-message")).length&&(e.forEach(function(e){e.onclick=function(){var e;"disabled"!==(this.getAttribute("disabled")||"")&&(this.parentNode.remove(),t.querySelectorAll(".woostify-sale-notification-remove-message").length<=1&&(e=new Event("lastMessage"),document.documentElement.dispatchEvent(e)))}}),document.documentElement.addEventListener("lastMessage",function(){var e=t.querySelector(".woostify-sale-notification-remove-message");e&&e.setAttribute("disabled","disabled")}))},woostifySaleNotificationAddNewMessage=function(){var e=document.querySelector(".woostify-featured-setting"),t=!!e&&document.querySelector(".woostify-sale-notification-box-message"),o=t?t.querySelector(".woostify-sale-notification-message-inner"):"",s=o?o.querySelector(".woostify-sale-notification-remove-message").innerHTML:"",i='<div class="woostify-sale-notification-message-inner">';i+='<textarea name="woostify_sale_notification_message[]" required="required"></textarea>',i+='<span class="woostify-sale-notification-remove-message button">'+s+"</span>",i+="</div>",e&&t&&o&&((e=e.querySelector(".woostify-sale-notification-add-message"))&&(e.onclick=function(){t.insertAdjacentHTML("beforeend",i),woostifySaleNotificationRemoveMessage();var e=t.querySelector(".woostify-sale-notification-message-inner:last-of-type"),e=!!e&&e.querySelector("textarea");e&&e.focus();e=t.querySelector('.woostify-sale-notification-remove-message[disabled="disabled"]');e&&e.removeAttribute("disabled")}))},woostifyHeaderFooterBuilderSelectTemplate=function(){var e=document.getElementById("woostify-header-footer-builder-template");e&&e.addEventListener("change",function(){var e,t,o,s=this.value;"default"===s?this.closest(".input-wrapper").nextElementSibling.remove():(t=this.closest(".input-wrapper"),e=nextSiblings(t),t=document.getElementById("woostify-hfb-nonce").value,0===e.length&&(o=new Request(ajaxurl,{method:"POST",body:"action=woostify_pro_select_template&_ajax_nonce="+t+"&template="+s,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}),fetch(o).then(function(e){200===e.status?e.json().then(function(e){e.success&&""!==e.data&&(e=(new DOMParser).parseFromString(e.data,"text/html").querySelector(".input-wrapper"),document.querySelector(".woostify-pro-hfb-options-wrapper").append(e))}):console.log("Status Code: "+e.status)})),null!==(o=document.querySelector(".condition-group.sticky"))&&("header"===s?o.classList.contains("hidden")&&o.classList.remove("hidden"):o.classList.contains("hidden")||o.classList.add("hidden")))})},woostifyChangeDisplayOption=function(){var i;document.getElementById("woostify-hfb-nonce")&&(i=document.getElementById("woostify-hfb-nonce").value,document.addEventListener("change",function(e){var t=e.target,o=t.getAttribute("id");"woostify-header-footer-builder-display-on"!==o&&"woostify-header-footer-builder-no-display-on"!==o||(e=t.options[t.selectedIndex].value,o=new Request(ajaxurl,{method:"POST",body:"action=woostify_pro_load_autocomplete&_ajax_nonce="+i+"&post_type="+e+"&type="+("woostify-header-footer-builder-no-display-on"===o?"no_display_on":"display_on"),credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}),fetch(o).then(function(e){200===e.status?e.json().then(function(e){e.success&&(t.closest(".condition-group").getElementsByClassName("child-item")[0].innerHTML=e.data)}):console.log("Status Code: "+e.status)}))}),document.addEventListener("click",function(e){var t,o,s,i,n=e.target||e.currentTarget;n.getAttribute("class");if(n.classList.contains("woostify-select-all-post")||n.classList.contains("woostify-arrow")||n.classList.contains("woostify-select-all")){for(var a,c,l=(a=n.closest(".woostify-section-select-post")).children.length,r=0;r<l;r++)if(a.children[r].classList.contains("woostify-section-render--post")){c=a.children[r];break}c.classList.contains("hidden")?(c.classList.remove("hidden"),a.classList.remove("select-all"),a.classList.add("render--post"),a.getElementsByClassName("woostify--hf-post-name")[0].focus()):(c.classList.add("hidden"),a.classList.remove("render--post"),a.classList.add("select-all"))}if(n.classList.contains("woostify-auto-complete-field")&&n.querySelector(".woostify--hf-post-name").focus(),n.classList.contains("post-item")&&!n.classList.contains("disabled")&&(i=(o=n.closest(".input-item-wrapper")).querySelector(".woostify-post-ids").value,t=o.querySelector(".woostify-select-all-post"),e=o.querySelector(".woostify-section-select-post"),t.classList.contains("hidden")||t.classList.add("hidden"),i=i&&"all"!==i?i.split(","):[],e.classList.contains("has-option")||e.classList.add("has-option"),t=n.getAttribute("data-item"),e=n.textContent,i.includes(t)||(i.push(t),e='<span class="woostify-title">'+e+'</span><span class="btn-woostify-auto-complete-delete ion-close" data-item="'+t+'"></span>',(s=document.createElement("span")).classList.add("woostify-auto-complete-key"),s.innerHTML=e,o.querySelector(".woostify-auto-complete-field").insertBefore(s,o.querySelector(".woostify--hf-post-name"))),o.querySelector(".woostify-post-ids").value=i,o.querySelector(".woostify--hf-post-name").value="",n.classList.add("disabled")),n.classList.contains("btn-woostify-auto-complete-delete")&&(t=n.getAttribute("data-item"),i=(o=n.closest(".input-item-wrapper")).querySelector(".woostify-post-ids").value,c=o.querySelector(".woostify-section-render--post"),s=o.querySelector(".woostify-select-all-post"),a=o.querySelector(".woostify-section-select-post"),o.closest(".condition-group"),""!==(i=i&&"all"!==i?(i=i.replace(","+t,"")).replace(t,""):[])&&null!=i||(i="all",c.classList.add("hidden"),a.classList.remove("render--post"),a.classList.add("select-all"),a.classList.remove("has-option"),s.classList.remove("hidden"),o.querySelector(".woostify-data").innerHTML=""),o.querySelector(".woostify-post-ids").value=i,n.parentElement.remove()),"woostify-header-template-sticky"===n.getAttribute("name")&&(i=document.querySelector('input[name="woostify-header-template-sticky"]').checked,n=n.closest(".condition-group").querySelector(".child-item"),i?n.classList.contains("hidden")&&n.classList.remove("hidden"):n.classList.contains("hidden")||n.classList.add("hidden")),0<document.querySelectorAll(".woostify--hf-post-name").length)for(var d=document.querySelectorAll(".woostify--hf-post-name"),u=d.length,f=0;f<u;f++)d[f].value="";if(0<document.querySelectorAll(".woostify-data").length)for(var y=document.querySelectorAll(".woostify-data"),m=y.length,h=0;h<m;h++)y[h].innerHTML=""}),document.addEventListener("keyup",function(e){var t,o,s=e.target;s.classList.contains("woostify--hf-post-name")&&(o=(t=s.closest(".input-item-wrapper")).querySelector(".woostify-post-type").value,e=t.querySelector(".woostify-post-ids").value,s=s.value,e=new Request(ajaxurl,{method:"POST",body:"action=woostify_pro_load_post&_ajax_nonce="+i+"&post_type="+o+"&key="+s+"&selected="+e,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}),fetch(e).then(function(e){200===e.status?e.json().then(function(e){e.success&&(t.getElementsByClassName("woostify-data")[0].innerHTML=e.data)}):console.log("Status Code: "+e.status)}))}))};document.addEventListener("DOMContentLoaded",function(){"function"==typeof woostifyMoveWordpressUpdateVersionNotice&&woostifyMoveWordpressUpdateVersionNotice(),woostifyMultiSelect(),woostifyDependency(),woostifyMultiDependency(),woostifyUpdateValue(),woostifyTabSettings(),woostifySaveOptions(),woostifySaleNotificationAddNewMessage(),woostifySaleNotificationRemoveMessage(),woostifyHeaderFooterBuilderSelectTemplate(),woostifyChangeDisplayOption()});