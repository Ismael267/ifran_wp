"use strict";var woostifyRangeValue=function(){var e,t,o,i=document.querySelector(".w-filter-check-range");i&&((e=function(){var e=i.querySelectorAll(".w-filter-item-pack");e.length&&e.forEach(function(e){var t=e.querySelector(".w-filter-range-item-remove");t&&(t.onclick=function(){e.remove()})})})(),t=i.querySelector(".w-filter-container-inner"),o=i.querySelector(".w-filter-range-item-add"),t&&o&&(o.onclick=function(){t.insertAdjacentHTML("beforeend",woostify_product_filter.item_node),e()}))},woostifyUpdateAttr=function(){var o,i=document.querySelector('[name="woostify_product_filter_type"]');i&&(o=i.closest(".admin-product-filter"),i.addEventListener("change",function(){var e=document.querySelector('[name="woostify_product_filter_data"]'),t=document.querySelectorAll(".w-filter-check-range .w-filter-required");o.setAttribute("data-type",i.value),t.length&&("check-range"===i.value?t.forEach(function(e){e.setAttribute("required","required")}):t.forEach(function(e){e.removeAttribute("required"),e.value.trim()||e.closest(".w-filter-range-item").remove()})),"visual"===i.value&&e?(e.classList.add("product-attr-only"),(t=e.querySelector("[value="+e.value+"]"))&&t.classList.contains("product-taxonomy")&&(e.value="")):e.classList.remove("product-attr-only")}))},woostifyToggleCheckboxValue=function(){var e=document.querySelectorAll('.woostify-filter-item [type="checkbox"]');e.length&&e.forEach(function(a){function e(){var e=a.name,t=e+":"+a.value,o=document.querySelectorAll("[data-require]");if(o.length)for(var i=0,n=o.length;i<n;i++){var r=o[i].getAttribute("data-require");r.includes(e)&&(r===t?o[i].classList.remove("hidden"):o[i].classList.add("hidden"))}}e(),a.addEventListener("change",function(){a.value="1"==a.value?"0":"1",e()})})},woostifyProductCatData=function(){var e,t,o,i,n=document.querySelector('[name="woostify_product_filter_data"]'),r=document.querySelector(".w-filter-hierarchical-data");n&&r&&((e=function(){"product_cat"==n.value?r.classList.remove("hidden"):r.classList.add("hidden")})(),n.onchange=e,t=r.querySelector("#w-filter-source-term-hierarchical"),o=r.querySelector("#w-filter-source-term-hierarchical-expand"),i=document.querySelector(".soft-limit"),t&&o&&t.addEventListener("change",function(){var e=o.closest(".w-filter-field");"0"==t.value?(e.classList.add("hidden"),i&&i.classList.remove("soft-limit-hidden")):(e.classList.remove("hidden"),i&&i.classList.add("soft-limit-hidden"))}))},woostifyTermConditionData=function(){var e,t=document.querySelector(".w-filter-condition-data"),o=!!t&&t.querySelector(".w-filter-condition-select"),i=!!t&&t.querySelector(".w-filter-condition-field");o&&i&&((e=function(){o.value?i.classList.remove("hidden"):i.classList.add("hidden")})(),t.onchange=e)},woostifyFieldShowOn=function(e){e=document.querySelectorAll(e);e.length&&e.forEach(function(t){var e=t.getAttribute("showon").split(":"),o=e[0],i=!0;(i=void 0!==e[0].split("!")[1]?!1:i)||(o=e[0].split("!")[0]);var n=e[1],e=document.getElementsByName(o)[0],o=e.value;return i?(o===n?t.classList.remove("hidden"):t.classList.add("hidden"),e.addEventListener("change",function(e){e.target.value===n?t.classList.add("hidden"):t.classList.remove("hidden")})):(o!==n?t.classList.remove("hidden"):t.classList.add("hidden"),e.addEventListener("change",function(e){e.target.value===n?t.classList.add("hidden"):t.classList.remove("hidden")})),!1})},woostifySortableOrder=function(){var e=document.querySelector(".woostify-multi-selection-inner"),t=!!e&&e.closest(".woostify-multi-selection"),o=!!t&&t.querySelector(".woostify-multi-select-value");e&&(new Sortable(e),document.addEventListener("filterOrder",function(){var t=[];e.querySelectorAll(".woostify-multi-select-id").forEach(function(e){e=e.getAttribute("data-id");e&&!t.includes(e)&&t.push(e)}),o.value=t.join("|")}))},woostifyIndexDatabase=function(){var n=document.querySelector(".filter-index-button");n&&(n.onclick=function(){var e=n.closest(".form-table"),o=!!e&&e.querySelector(".last-index"),i=!!e&&e.querySelector(".index-count");o&&i&&!n.getAttribute("disabled")&&!n.parentNode.classList.contains("loading")&&(n.parentNode.classList.add("loading"),n.setAttribute("disabled","disabled"),n.innerHTML=woostify_product_filter.indexing_text+"...",e={action:"woostify_index_filter",ajax_nonce:woostify_product_filter.ajax_nonce},e=new URLSearchParams(e).toString(),e=new Request(ajaxurl,{method:"POST",body:e,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}),fetch(e).then(function(e){if(200!==e.status)throw console.log("Status Code: "+e.status),e;return e.json()}).then(function(e){var t;e.success&&(t=e.data,n.innerHTML=woostify_product_filter.indexed_text,n.insertAdjacentHTML("afterend",'<span class="info-seuccess">'+woostify_product_filter.indexed_success+"</span>"),n.parentNode.classList.remove("loading"),(e=document.querySelector(".woostify-filter-index-notice"))&&e.remove(),t.time&&(o.innerHTML=t.time),t.total&&(i.innerHTML=t.total))}).catch(function(){n.parentNode.classList.remove("loading")}))})},woostifySortableFilter=function(){var t=jQuery("table.wp-list-table #the-list");t.sortable({items:"tr",axis:"y",update:function(){var e=t.sortable("serialize");(e=(e=e.replaceAll("&post[]=",",")).replace("post[]=","")).includes(",")&&(e={action:"woostify_filter_list_sortable",post_ids:e,ajax_nonce:woostify_product_filter.ajax_sortable_nonce},e=new URLSearchParams(e).toString(),e=new Request(ajaxurl,{method:"POST",body:e,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}),fetch(e))}})},woostifySelectText=function(){var e=document.querySelectorAll(".w-filter-shortcode");e.length&&window.getSelection&&e.forEach(function(t){t.onclick=function(){var e=document.createRange();e.selectNode(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(e)}})};document.addEventListener("DOMContentLoaded",function(){woostifyToggleCheckboxValue(),woostifyRangeValue(),woostifyUpdateAttr(),woostifyProductCatData(),woostifyTermConditionData(),woostifySortableOrder(),woostifyIndexDatabase(),woostifyFieldShowOn(".woostify-smart-product-filter-product-setting tr[showon]"),woostifyFieldShowOn(".admin-product-filter tr[showon]"),woostifySortableFilter(),woostifySelectText()});