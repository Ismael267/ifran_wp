"use strict";var woostifyAutocompleteSearchDelay=function(e){var o=0<arguments.length&&void 0!==e?e:0;return function(e,t){clearTimeout(o),o=setTimeout(e,t)}}(),woostifyAutocompleteRender=function(){var t,o,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"post_type",a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"product",c=2<arguments.length?arguments[2]:void 0,e=c.el.querySelector(".wty-autocomplete");e&&c.getControlValue().length&&(t=c.el.querySelector(".elementor-control-title"),e={action:(o=e.querySelector(".wty-autocomplete-selection")).querySelector(".wty-autocomplete-selected").name,security_nonce:woostify_autocomplete.nonce,selected_id:c.getControlValue(),query:n,value:a},t&&t.insertAdjacentHTML("beforeend",'<i class="eicon-spinner eicon-animation-spin"></i>'),e=new URLSearchParams(e).toString(),e=new Request(ajaxurl,{method:"POST",body:e,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})}),fetch(e).then(function(e){200===e.status?e.json().then(function(e){e.success&&e.data&&(o.insertAdjacentHTML("afterbegin",e.data),woostifyAutocomplete(n,a,c))}):console.log("Status Code: "+e.status)}).catch(function(e){console.log(e)}).finally(function(){var e;!t||(e=t.querySelector(".eicon-spinner"))&&e.remove()}))},woostifyAutocomplete=function(){var n,a,c,i,r,l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"post_type",s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"product",u=2<arguments.length?arguments[2]:void 0,d=u.el.querySelector(".wty-autocomplete");d&&(n=d.querySelector(".wty-autocomplete-selection"),a=n.querySelector(".wty-autocomplete-search"),c=d.querySelector(".wty-autocomplete-dropdown"),i=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=n.querySelectorAll(".wty-autocomplete-id"),o=[];if(t.forEach(function(e){e=Number(e.getAttribute("data-id"));e&&!o.includes(e)&&o.push(e)}),!0===e)return o;u.setValue(o)},(r=function(){var e=n.querySelectorAll(".wty-autocomplete-id");e.length&&e.forEach(function(t){var o=t.getAttribute("data-id"),e=t.querySelector(".wty-autocomplete-remove-id");e&&(e.onclick=function(){var e;t.parentNode&&(d.classList.add("active"),(e=c.querySelector('[data-id="'+o+'"]'))&&e.classList.remove("disabled"),t.remove(),i())})})})(),a&&a.addEventListener("input",function(){var e=a.value.trim(),t={action:a.name,security_nonce:woostify_autocomplete.nonce,keyword:e,query:l,value:s},t=new URLSearchParams(t).toString(),o=new Request(ajaxurl,{method:"POST",body:t,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});e.length<1?c.innerHTML="":(c.innerHTML='<span class="wty-autocomplete-searching">'+woostify_autocomplete.searching+"</span>",woostifyAutocompleteSearchDelay(function(){fetch(o).then(function(e){200===e.status?e.json().then(function(e){var t;e.success&&((e=(t=(new DOMParser).parseFromString(e.data,"text/html")).querySelectorAll(".wty-autocomplete-id")).length&&e.forEach(function(e){var t=Number(e.getAttribute("data-id"))||"",o=i(!0)||[];o.length&&(o.includes(t)?e.classList.add("disabled"):e.classList.remove("disabled"))}),c.innerHTML=t.body.innerHTML,function(){var e=c.querySelectorAll(".wty-autocomplete-id");if(e.length)for(var t=0,o=e.length;t<o;t++)e[t].onclick=function(){var e=this,t=e.classList.contains("disabled"),o=e.getAttribute("data-id");t||(c.innerHTML="",a.value="",e.classList.add("disabled"),e='<span class="wty-autocomplete-id" data-id="'+o+'">'+e.innerHTML+'<i class="wty-autocomplete-remove-id eicon-close-circle"></i></span>',n.insertAdjacentHTML("afterbegin",e),i(),r())}}())}):console.log("Status Code: "+e.status)}).catch(function(e){c.innerHTML="",console.log(e)})},500))}))},woostifyAutocompleteData={onReady:function(){var e=this.model.get("query"),t=e.type,e=e.name;woostifyAutocompleteRender(t,e,this),woostifyAutocomplete(t,e,this)}},woostifyAutocompleteControl=elementor.modules.controls.BaseData.extend(woostifyAutocompleteData);elementor.addControlView("autocomplete",woostifyAutocompleteControl);